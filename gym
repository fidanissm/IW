import time
import json

# Data storage
members = []

# Task 1: Welcome screen with ASCII Art (Task 20)
def welcome_screen():
    print("""
  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó
 ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë
 ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë
 ‚ñà‚ñà‚ïë‚ñÑ‚ñÑ ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë
 ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïó‚ïö‚ñà‚ïê‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë
  ‚ïö‚ïê‚ïê‚ñÄ‚ñÄ‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù
          Welcome to Gym Membership System!
""")
    time.sleep(1)

# Task 2: Main menu
def main_menu():
    print("\nMain Menu:")
    print("1. Add New Member")
    print("2. View All Members")
    print("3. Search Member")
    print("4. Update Member")
    print("5. Delete Member")
    print("6. Summary Statistics")
    print("7. Save to File")
    print("8. Load from File")
    print("9. Help")
    print("10. Clear All Data")
    print("0. Exit")

# Task 3: Add new record
def add_member():
    try:
        member_id = input("Enter Member ID: ")
        name = input("Enter Name: ")
        age = int(input("Enter Age: "))
        balance = float(input("Enter Balance: "))
        members.append({'ID': member_id, 'Name': name, 'Age': age, 'Balance': balance})
        print("‚úÖ Member added.")
    except ValueError:
        print("‚ùå Invalid input. Age and Balance must be numbers.")

# Task 4: Store using list of dicts (already used)

# Task 5: View all members
def view_members():
    if not members:
        print("üì≠ No records found.")
        return
    for m in members:
        print(f"ID: {m['ID']} | Name: {m['Name']} | Age: {m['Age']} | Balance: ${m['Balance']:.2f}")

# Task 6: Search member
def search_member():
    keyword = input("Enter ID or Name to search: ").lower()
    found = [m for m in members if keyword in m['ID'].lower() or keyword in m['Name'].lower()]
    if found:
        for m in found:
            print(f"ID: {m['ID']} | Name: {m['Name']} | Age: {m['Age']} | Balance: ${m['Balance']:.2f}")
    else:
        print("üîç No match found.")

# Task 7: Update member
def update_member():
    member_id = input("Enter ID to update: ")
    for m in members:
        if m['ID'] == member_id:
            m['Name'] = input("Enter new name: ")
            try:
                m['Age'] = int(input("Enter new age: "))
                m['Balance'] = float(input("Enter new balance: "))
                print("‚úÖ Member updated.")
            except ValueError:
                print("‚ùå Invalid age or balance.")
            return
    print("‚ùå Member not found.")

# Task 8: Delete member
def delete_member():
    member_id = input("Enter ID to delete: ")
    global members
    members = [m for m in members if m['ID'] != member_id]
    print("üóëÔ∏è Member deleted if ID was found.")

# Task 10: Summary statistics
def summary_statistics():
    if not members:
        print("üìâ No data for statistics.")
        return
    avg_age = sum(m['Age'] for m in members) / len(members)
    total_balance = sum(m['Balance'] for m in members)
    print(f"üìä Average Age: {avg_age:.2f}")
    print(f"üí∞ Total Balance: ${total_balance:.2f}")

# Task 11: Save to file
def save_to_file():
    with open("members.json", "w") as f:
        json.dump(members, f)
    print("üíæ Data saved to members.json.")

# Task 12: Load from file
def load_from_file():
    global members
    try:
        with open("members.json", "r") as f:
            members = json.load(f)
        print("üìÇ Data loaded from file.")
    except FileNotFoundError:
        print("‚ùå File not found.")

# Task 13: Input validation (handled in places above)

# Task 15: Try-except blocks used throughout

# Task 16: Sort by name
def sort_members():
    if not members:
        print("üì≠ No records to sort.")
        return
    sorted_list = sorted(members, key=lambda m: m['Name'])
    for m in sorted_list:
        print(f"{m['Name']} - ID: {m['ID']}, Age: {m['Age']}, Balance: ${m['Balance']:.2f}")

# Task 17: Recursive count
def count_recursive(index=0):
    if index >= len(members):
        return 0
    return 1 + count_recursive(index + 1)

# Task 18: Help menu
def help_menu():
    print("""
üÜò Help - Menu Options:
1 - Add a new gym member
2 - View all saved members
3 - Search by ID or name
4 - Update a member's data
5 - Delete a member
6 - Show average age and total balance
7 - Save all data to file
8 - Load data from file
9 - View help
10 - Clear all records
0 - Exit
""")

# Task 19: Clear all data
def clear_all_data():
    confirm = input("Are you sure you want to delete ALL data? (yes/no): ").lower()
    if confirm == 'yes':
        members.clear()
        print("‚ö†Ô∏è All data cleared.")
    else:
        print("‚ùå Cancelled.")

# Main loop
def run():
    welcome_screen()
    while True:
        main_menu()
        try:
            choice = int(input("Enter your choice: "))
            if choice == 1:
                add_member()
            elif choice == 2:
                view_members()
            elif choice == 3:
                search_member()
            elif choice == 4:
                update_member()
            elif choice == 5:
                delete_member()
            elif choice == 6:
                summary_statistics()
            elif choice == 7:
                save_to_file()
            elif choice == 8:
                load_from_file()
            elif choice == 9:
                help_menu()
            elif choice == 10:
                clear_all_data()
            elif choice == 0:
                print("üëã Goodbye!")
                break
            else:
                print("‚ùå Invalid choice.")
        except ValueError:
            print("‚ùå Please enter a valid number.")

# Run the program
run()
